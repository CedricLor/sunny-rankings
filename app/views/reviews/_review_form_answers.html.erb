<% user_rating_option_array = [] %>
<% @tests[a.index].select_options.split(";").each_with_index do |answer, i| %>
  <% user_rating_option_array << ["x", i + 1] %>
  <!-- + 1 is here to fix minimum grade to 1 and maximum to 5 instead of 0 and 4 respect. -->
<% end %>

<%= a.input :user_rating,
    as: :radio_buttons,
    boolean_style: :inline,
    collection: (user_rating_option_array),
    label: "#{@tests[a.index].test_long_question}",
    label_html: {
      class: "block"
      },
    wrapper_html: {
      class: "text-center my-rating-wrapper"
    },
    item_wrapper_class: "inline-block",
    input_html: {
      class: "rating-input my-hidden-input"
    }
  %>
<div class="vote-impact-wrapper" data-prior-answers-count='<%= @answer_count_by_test[a.index + 1] %>' data-prior-answers-total='<%= @total_by_test[a.index + 1] %>'>

    <table class="table table-striped table-responsive">
      <tr>
        <td>
          Current rating
        </td>
        <td>
          <span class="badge"><%= @avg_ratings_by_test.fetch(a.index + 1).to_f.round(1) %></span>
        </td>
        <td>
          <span class="badge trend-badge">
            <% if (@current_averages[a.index + 1].to_f > @previous_averages[a.index + 1].to_f) %>
              <%  css_class = "rotate-right-up" %>
            <% elsif @current_averages[a.index + 1].to_f < @previous_averages[a.index + 1].to_f %>
              <% css_class = "rotate-right-down" %>
            <% else %>
              <% css_class = "rotate-neutral" %>
            <% end %>
              <i class="fa fa-long-arrow-up fa-lg <%= "#{css_class}" %>"></i>
          </span>
        </td>
      </tr>
      <tr class="your-impact my-hidden-class">
        <td>
          Your potential impact
        </td>
        <td>
          <span class="badge average"></span>
        </td>
        <td>
          <span class="badge trend-badge">
            <%#= link_to("#", html_options = { class: "neutral-a-links" }) do %>
              <i class="fa fa-long-arrow-up fa-lg"></i>
            <%# end %>
          </span>
        </td>
      </tr>
    </table>

</div>
<hr/>


<!-- TODO Erase
  This partial is called from the firms' controller (first review), the profile controller (validation) and the review controller (pendingreview and new review).
  The method to get the number of prior answers count and prior answers total should be
  located in the answers model.
  However, it should be made accessible from the calling controllers.
-->